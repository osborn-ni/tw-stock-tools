# 📋 台灣證券市場原始清單筆記

### 1. 數據源頭 (The Source)

這兩個網頁是證交所提供的 **「所有公開發行證券編碼」** 查詢頁面，資料每天動態更新：

* **上市證券 (TWSE):** [isin.twse.com.tw/isin/C_public.jsp?strMode=2](https://isin.twse.com.tw/isin/C_public.jsp?strMode=2)
* **上櫃證券 (TPEx):** [isin.twse.com.tw/isin/C_public.jsp?strMode=4](https://isin.twse.com.tw/isin/C_public.jsp?strMode=4)

---

### 2. 關鍵欄位解析

#### **A. 國際證券辨識號碼 (ISIN Code)**

* **全稱：** International Securities Identification Number。
* **結構：** 由 **12 位字元**組成的英文加數字編碼。
* **台灣規範：** 台灣的 ISIN 通常以 `TW` 開頭。例如：台積電 (2330) 的 ISIN 為 `TW0002330008`。
* **為什麼需要它？**
* **唯一性：** 全球唯一。雖然我們習慣叫「2330」，但在國際交易系統中，`2330` 可能在其他國家的股市也存在，只有 ISIN Code 絕對不會重複。
* **資料對接：** 如果你未來要串接國際財經 API（如 Bloomberg 或 Reuters），它們通常是用 ISIN 作為關鍵字。



#### **B. CFI Code (重點！過濾神器)**

* **全稱：** Classification of Financial Instruments (金融工具分類代碼)。
* **結構：** 固定為 **6 位英文字母**。
* **意義：** 這是一套國際標準（ISO 10962），用來描述這項證券的「本質」。
* **代碼拆解（以普通股 `ESVUFR` 為例）：**
1. **第一碼 `E` (Equity):** 權益證券（股票類）。
2. **第二碼 `S` (Shares):** 普通股（如果是 `F` 則代表優先股）。
3. **第三碼 `V` (Voting):** 有投票權。
4. **第四碼 `U` (Unrestricted):** 轉讓不受限。
5. **第五碼 `F` (Fully Paid):** 已全額繳清股款。
6. **第六碼 `R` (Registered):** 記名式。



> **💡 你的過濾秘訣：**
> * 如果你只要 **「一般股票」**：請過濾 `CFICode == 'ESVUFR'`。
> * 如果你要 **「ETF」**：請找 `CFICode == 'CEOGDU'` 或開頭為 `C` 的代碼。
> * 如果你要 **「權證」**：請找開頭為 `R` (Rights) 的代碼。
> 
> 

---

### 3. 欄位對照表 (常見混亂校正)

這兩個網頁的 HTML 表格沒有明確的 `<thead>`，所以爬蟲抓下來時，建議手動校正欄位名稱如下：

| 原始欄位名 (可能會有空格或換行) | 建議對應程式變數 | 說明 |
| --- | --- | --- |
| 有價證券代號及名稱 | `sid_name` | 包含代碼與中文 (例: `2330　台積電`) |
| 國際證券辨識號碼(ISIN Code) | `isin_code` | 12 位全球通用編碼 |
| 上市日 | `listing_date` | 格式通常為 `YYYY/MM/DD` |
| 市場別 | `market_type` | 上市、上櫃或興櫃 |
| 產業別 | `industry_type` | 例如：半導體業、金融業 |
| CFICode | `cfi_code` | 用來區分股票、ETF 或權證的關鍵 |

---

### 4. 給開發者的建議 (避免重蹈覆轍)

1. **不要相信原始欄位名：** 就像你之前遇到的，不同市場別的網頁，欄位順序或名稱可能有微小差異。程式裡一定要用 **索引位置** 或 **強迫更名** 來處理。
2. **編碼處理：** 這兩個網頁使用的是 `MS950` (繁體中文 Big5)，用 Python 的 `requests` 抓取後，記得設定 `res.encoding = 'ms950'`，否則中文會變亂碼。
3. **分身術應用：** 你的 20 個分身在執行前，應該**先共同抓取這份清單一次**，然後再根據 `worker_id` 領走屬於自己的股票區段。

---
